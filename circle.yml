version: 1
dependencies:
 override:
   - npm install
 post:
   - npm run build

test:
 override:
   - npm test

deployment:
 prod:
   branch: master
   heroku:
     appname: octobiwan


# version: 2
# jobs:
#   build:
#     working_directory: ~/myapp
#     docker:
#       - image: circleci/node:4.8.2
#     steps:
#       - checkout
#       - run:
#           name: 'Update NPM'
#           command: 'sudo npm install -g npm@latest'
#       - restore_cache:
#           key: dependency-cache-{{ checksum "package.json" }}
#       - run:
#           name: 'NPM Install'
#           command: npm install
#       - run:
#           name: 'Build App'
#           command: npm run build
#       - save_cache:
#           key: dependency-cache-{{ checksum "package.json" }}
#           paths:
#             - ./node_modules
#       - save_cache:
#           key: app-cache-{{ checksum "package-lock.json" }}
#           paths:
#             - ~/myapp/public

#   deploy:
#     machine:
#       enabled: true
#     working_directory: ~/myapp
#     environment:
#       - HEROKU_APP: octobiwan
#     steps:
#       - restore_cache:
#           dependency-cache-{{ checksum "package.json" }}
#       - restore_cache:
#           app-cachce-{{ checksum "package-lock.json" }}
#       - run:
#           command: |
#             git push heroku master
